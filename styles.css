/* 全域變數 & 主題 */
:root {
  --bg: #F5F5F7;
  --card: #FFFFFF;
  --muted: #6B6B70;
  --primary-color: #111113;
  --accent: #276EF1;
  --on-accent: #ffffff;
  --border: rgba(0,0,0,0.06);
  --shadow-sm: 0 1px 2px rgba(0,0,0,0.04);
  --shadow-lg: 0 8px 24px rgba(0,0,0,0.08);
  --radius: 14px;
  --gap: 24px;
}

/* 深色主題 */
[data-theme='dark'] {
  --bg: #0b0b0d;
  --card: #111214;
  --muted: #9CA3AF;
  --primary-color: #F8FAFC;
  --accent: #60a5fa;
  --on-accent: #ffffff;
  --border: rgba(255,255,255,0.06);
}

/* 重置 */
* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0; padding: 40px 20px; font-family: 'Noto Sans TC', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
  background: var(--bg); color: var(--primary-color); -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; line-height: 1.5;
}

.container { max-width: 1000px; margin: 0 auto; }
.header { display:flex; flex-direction:column; align-items:center; gap:12px; margin-bottom:40px; text-align:center; position:relative; }
.title { margin:0; font-size:2.4rem; font-weight:700; }
.nav-menu { display:flex; gap:12px; margin-top:8px; }
.nav-link { padding:8px 18px; border-radius:24px; text-decoration:none; color:var(--muted); background:transparent; border:1px solid var(--border); font-weight:600; }
.nav-link:hover, .nav-link:focus { transform:translateY(-2px); box-shadow:var(--shadow-sm); color:var(--primary-color); }
.nav-link.active { background:var(--accent); color:var(--on-accent); border-color:var(--accent); }

/* 主體網格 */
.grid { display:grid; grid-template-columns: 1fr; gap:var(--gap); }
.card { 
  background:var(--card); 
  border-radius:var(--radius); 
  padding:18px; 
  border:1px solid var(--border); 
  box-shadow:var(--shadow-sm); 
  transition:transform .28s ease, box-shadow .28s ease; 
  opacity:0; 
  transform:translate3d(0, 8px, 0);
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
}
.card:hover, .card:focus-within { 
  transform:translate3d(0, -6px, 0); 
  box-shadow:var(--shadow-lg); 
}

.card.visible { opacity:1; transform:none; }
.card h2 { margin:0 0 8px 0; font-size:1.05rem; }
.embed-wrap { display:flex; align-items:center; justify-content:center; min-height:120px; }

/* 性能優化:減少重繪 */
.card, .nav-link, .back-to-top, .theme-toggle {
  contain: layout style paint;
}

/* 響應式 */
@media (min-width:720px) { .grid { grid-template-columns: repeat(2, 1fr); } }
@media (min-width:1024px) { body { padding:60px 40px; } .title { font-size:3rem; } .grid { gap:32px; grid-template-columns:repeat(auto-fill, minmax(340px, 1fr)); } }

/* Page transition */
#page-content > .grid {
  transition: opacity 0.3s ease-in-out;
}

/* Animation - GPU 加速優化 */
@keyframes fadeIn { 
  from { opacity:0; transform: translate3d(0, 18px, 0);} 
  to { opacity:1; transform: translate3d(0, 0, 0); } 
}
.card { 
  animation: fadeIn .45s ease-out; 
  will-change: opacity, transform;
}
.card:nth-child(1) { animation-delay: .05s;} 
.card:nth-child(2) { animation-delay: .1s;} 
.card:nth-child(3) { animation-delay: .15s;} 
.card:nth-child(4) { animation-delay: .2s; }
.card.visible { will-change: auto; }

/* Accessibility */
.nav-link:focus, .nav-link:active, button:focus { outline: 3px solid rgba(39,110,241,0.14); outline-offset: 2px; }

/* Back-to-top & Theme Toggle */
.back-to-top { 
  position: fixed; 
  right: 28px; 
  bottom: 28px; 
  width:44px; 
  height:44px; 
  border-radius:50%; 
  background:var(--accent); 
  color:var(--on-accent); 
  border:none; 
  display:inline-flex; 
  align-items:center; 
  justify-content:center; 
  font-size:20px; 
  cursor:pointer; 
  opacity:0; 
  visibility:hidden; 
  transition:opacity .22s ease, transform .12s ease; 
  z-index:999;
  will-change: opacity, transform;
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
}
.back-to-top.visible { opacity:1; visibility:visible; }
.back-to-top:hover { transform:scale3d(1.06, 1.06, 1); }
.theme-toggle { position: absolute; right: 0; top: 0; transform: translate(12px,-12px); border: none; background: var(--card); padding:8px; border-radius:8px; cursor:pointer; box-shadow: var(--shadow-sm); }
.theme-toggle[aria-pressed='true'] { background: var(--accent); color: var(--on-accent); }

/* Pulse - GPU 加速 */
@keyframes pulse { 
  0% { transform: scale3d(1, 1, 1); } 
  35% { transform: scale3d(.96, .96, 1); } 
  100% { transform:scale3d(1, 1, 1); } 
}
.pulse { 
  animation: pulse .28s ease-in-out; 
  will-change: transform;
}

/* Threads embed custom overrides (保留現有樣式優先) */
.text-post-media { background: var(--card) !important; border-radius:12px !important; max-width:100% !important; margin:0 auto !important; padding:0 !important; box-sizing:border-box !important; border: 1px solid rgba(0,0,0,0.14) !important; }
.threads-embed-link, .threads-embed-content { width:100% !important; }

/* Custom focus color in dark theme */
[data-theme='dark'] button:focus, [data-theme='dark'] .nav-link:focus { outline-color: rgba(96,165,250,0.25); }
